{% extends 'core/base.html' %}

{% load static%}

{% load crispy_forms_tags %}

{% block contenido%}

<style>
</style>

<div class="container mt-5 pt-5">

    <div class="col-lg-12 my-5">
        <div class="d-flex justify-content-end">
            <a class="btn btn-info"  target="_blank" href="{%  static 'core/manuales/manual_registro_cliente.pdf' %}">Manual Registrar Cliente</a>
        </div>
    </div>

        

    <div class="row mt-5 pt-5">

        <div class="mt-3">
            <h3>Registrar Cliente</h3>
        </div>

        <div class="col-lg-12 pt-5 mt-5">

            <form class="form-group" action="" method="POST" id="formulario_registro_cliente">
                {% csrf_token %}

                <hr>
                <h5>Datos Usuario</h5>
                <hr>
    
                <div class=" form-user">
                    {{form | crispy}}
                </div>
                <div class="row">
                    <div class="col-lg-4">
                        <hr>
                            <h5>Datos Cliente</h5>
                        <hr>

                        <div class="form-group">
                            <label for="txtRutCliente">Rut Cliente</label>
                            <input type="text" class="form-control" name="txtRutCliente" id="txtRutCliente" placeholder="Rut Cliente">
                            <small class="">Si su rut termina en k reemplace por un 1</small>
                        </div>

                        <div class="form-group">
                            <label for="txtNombres">Nombre Cliente</label>
                            <input type="text" class="form-control" name="txtNombres" id="txtNombres" placeholder="Nombre Cliente">
                        </div>

                        <div class="form-group">
                            <label for="txtaPaterno">Apellido Paterno</label>
                            <input type="text" class="form-control" name="txtaPaterno" id="txtaPaterno" placeholder="Apellido Paterno">
                        </div>

                        <div class="form-group">
                            <label for="txtaMaterno">Apellido Materno</label>
                            <input type="text" class="form-control" name="txtaMaterno" id="txtaMaterno" placeholder="Apellido Materno">
                        </div>

                        <div class="form-group">
                            <label for="txtTelefono">Telefono</label>
                            <input type="number" class="form-control" name="txtTelefono" id="txtTelefono" placeholder="Telefono">
                        </div>

                        <div class="form-group">
                            <label for="txtTelefono2">Telefono Opcional</label>
                            <input type="number" class="form-control" name="txtTelefono2" id="txtTelefono2" placeholder="Telefono Opcional">
                        </div>

                        <div class="form-group">
                            <label for="txtCorreo">Correo</label>
                            <input type="email" class="form-control" name="txtCorreo" id="txtCorreo" placeholder="Correo">
                        </div>

                    </div>

                    <div class="col-lg-4">

                        <hr>
                            <h5>Datos Empresa</h5>
                        <hr>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="esEmpresa">
                            <label class="form-check-label" for="esEmpresa">
                              Es Empresa
                            </label>
                        </div>

                        <div class="form-group mt-3">
                            <label for="txtRutEmpresa">Rut Empresa</label>
                            <input type="text" class="form-control" name="txtRutEmpresa" id="txtRutEmpresa" placeholder="Rut Empresa">
                        </div>

                        <div class="form-group mt-3">
                            <label for="txtRazonSocial">Razon Social</label>
                            <input type="text" class="form-control" name="txtRazonSocial" id="txtRazonSocial" placeholder="Razon Social">
                        </div>

                        
                        <div class="form-group my-3">
                            <label for="txtGiro">Giro</label>
                            <input type="text" class="form-control" name="txtGiro" id="txtGiro" placeholder="Giro">
                        </div>


                        
                    </div>

                    <div class="col-lg-4">
                        <hr>
                            <h5>Datos Direccion</h5>
                        <hr>
                        {{formDir | crispy}}
                    </div>
                </div>



    
                <input class="btn btn-info"type="reset" value="Limpiar Datos">
                <input class="btn btn-success" type="submit" value="Registrar Cliente">
            </form>

            {% if mensaje %}
            
            <div class="alert alert-success" role="alert">
                
                {{mensaje}}
            </div>
            {% endif%}
        </div>
    </div>


    <style>
        #id_username-error, 
        #id_first_name-error, #id_last_name-error, 
        #id_email-error, #id_password1-error, 
        #id_password2-error, #txtRutCliente-error, 
        #txtNombres-error, #id_calle-error, #txtaPaterno-error, 
        #txtaMaterno-error, #txtTelefono-error, #txtCorreo-error, #id_numero-error, 
        #id_piso-error, #id_codigo_postal-error, #id_tipo_vivienda_id_tipo_vivienda-error, 
        #id_comuna_id_comuna-error{
            color:red !important;
        }
    </style>

</div>


{%endblock%}



{% block js%}

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js" integrity="sha256-FEqEelWI3WouFOo2VWP/uJfs1y8KJ++FLh2Lbqc8SJk=" crossorigin="anonymous"></script>  

<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/jquery.validate.min.js"></script>

<script>

  // Call the dataTables jQuery plugin
  $(document).ready(function() {

    //version traducida

	jQuery.extend(jQuery.validator.messages, {
  	required: "Este campo es obligatorio.",
  	remote: "Por favor, rellena este campo.",
  	email: "Por favor, escribe una dirección de correo válida",
  	url: "Por favor, escribe una URL válida.",
  	date: "Por favor, escribe una fecha válida.",
  	dateISO: "Por favor, escribe una fecha (ISO) válida.",
  	number: "Por favor, escribe un número entero válido.",
  	digits: "Por favor, escribe sólo dígitos.",
  	creditcard: "Por favor, escribe un número de tarjeta válido.",
  	equalTo: "Por favor, escribe el mismo valor de nuevo.",
  	accept: "Por favor, escribe un valor con una extensión aceptada.",
  	maxlength: jQuery.validator.format("Por favor, no escribas más de {0} caracteres."),
  	minlength: jQuery.validator.format("Por favor, no escribas menos de {0} caracteres."),
  	rangelength: jQuery.validator.format("Por favor, escribe un valor entre {0} y {1} caracteres."),
  	range: jQuery.validator.format("Por favor, escribe un valor entre {0} y {1}."),
  	max: jQuery.validator.format("Por favor, escribe un valor menor o igual a {0}."),
  	min: jQuery.validator.format("Por favor, escribe un valor mayor o igual a {0}.")
	});


    var validator = $('#formulario_registro_cliente').validate({
        rules:{
            username:{
                required:true, 
                minlength:4
            }, 
            first_name:{
                required:true,
                minlength:2
            }, 
            last_name:{
                required:true,
                minlength:10
            },
            email:{
                required:true, 
                email:true
            },
            password1:{
                required:true
            },
            password2:{
                required:true
            },
            txtRutCliente:{
                required:true,
                number:true, 
                minlength:9
            }, 
            txtNombres:{
                required:true
            }, 
            txtaPaterno:{
                required:true
            }, 
            txtaMaterno:{
                required:true
            }, 
            txtTelefono:{
                required:true,
                minlength:9, 
                number:true
            }, 
            txtCorreo:{
                required:true,
                email:true
            }, 
            numero:{
                required:true, 
                number:true, 
                min:1
            },
            calle:{
                required:true, 
                minlength:3
            }, 
            piso:{
                required:true, 
                min:1
            }, 
            codigo_postal:{
                required:true, 
                min:10
            }, 
            tipo_vivienda_id_tipo_vivienda:{
                required:true
            }, 
            comuna_id_comuna:{
                required:true
            }
        }
    })

    $('#txtRutEmpresa').attr('readonly', true);
    $('#txtRazonSocial').attr('readonly', true);
    $('#txtGiro').attr('readonly', true);

    $('#txtNombres').attr('readonly', true);
    $('#txtaPaterno').attr('readonly', true);
    $('#txtaMaterno').attr('readonly', true);
    $('#txtCorreo').attr('readonly', true);


    $("#id_first_name").keyup(function(){
        nombre = ($("#id_first_name").val())
        $('#txtNombres').val(nombre);
    });

    $("#id_last_name").keyup(function(){
        nombre = ($("#id_last_name").val())

        primer_apellido = nombre.split(" ")[0]
        segundo_apellido = nombre.split(" ")[1]
        
        $('#txtaPaterno').val(primer_apellido);
        $("#txtaMaterno").val(segundo_apellido);
    });

    $("#id_email").keyup(function(){
        nombre = ($("#id_email").val())
        $('#txtCorreo').val(nombre);
    });

    




    $('#esEmpresa').click(function() {
        if ($(this).is(':checked')) {
            $('#txtRutEmpresa').attr('readonly', false);
            $('#txtRazonSocial').attr('readonly', false);
            $('#txtGiro').attr('readonly', false);
    } else {


            $('#txtRutEmpresa').attr('readonly', true);
            $('#txtRazonSocial').attr('readonly', true);
            $('#txtGiro').attr('readonly', true);

            $('#txtRutEmpresa').val('');
            $('#txtRazonSocial').val('');
            $('#txtGiro').val('');
    }
});

    
  });
      //      jQuery.datetimepicker.setLocale('es');


    </script>
{%endblock%}